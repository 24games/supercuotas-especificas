<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supercuota Haaland vs Mbappé</title>
</head>
<body>
    <script>
        // Função para gerar o link padrão com UTM baseado na slug do domínio
        function gerarLinkPadrao(linkBase) {
            // Pega o hostname (domínio) da página atual
            const hostname = window.location.hostname;
            
            // Extrai a slug do domínio (remove www., protocolo, etc)
            let slug = hostname
                .replace(/^www\./, '') // Remove www.
                .toLowerCase();
            
            // Se for um subdomínio, pega apenas o subdomínio (parte antes do primeiro ponto)
            // Se não for subdomínio, pega o domínio principal sem a extensão
            const parts = slug.split('.');
            if (parts.length > 2) {
                // É um subdomínio (ex: slug.exemplo.com -> slug)
                slug = parts[0];
            } else if (parts.length === 2) {
                // É um domínio simples (ex: exemplo.com -> exemplo)
                slug = parts[0];
            }
            
            // Se não houver slug válida, usa um padrão
            if (!slug || slug === 'localhost' || slug === '127.0.0.1') {
                slug = 'default';
            }
            
            // Se não foi passado link base, usa um padrão
            if (!linkBase) {
                linkBase = 'https://exemplo.com/landing'; // ALTERE AQUI COM SEU LINK BASE
            }
            
            // Cria um objeto URL para manipular os parâmetros
            try {
                const url = new URL(linkBase);
                
                // Adiciona/atualiza os parâmetros UTM com a slug no final
                url.searchParams.set('utm_source', slug);
                url.searchParams.set('utm_medium', url.searchParams.get('utm_medium') || 'referral');
                url.searchParams.set('utm_campaign', url.searchParams.get('utm_campaign') || 'supercuota');
                
                // GARANTE que o affiliateId seja sempre 503785 (substitui se já existir)
                url.searchParams.set('affiliateId', '503785');
                
                return url.toString();
            } catch (e) {
                // Se o link base não for uma URL válida, monta manualmente
                const separator = linkBase.includes('?') ? '&' : '?';
                return `${linkBase}${separator}utm_source=${slug}&utm_medium=referral&utm_campaign=supercuota&affiliateId=503785`;
            }
        }
        
        // Exemplo de uso: quando a página carregar, você pode usar o link
        window.addEventListener('DOMContentLoaded', function() {
            const linkPadrao = gerarLinkPadrao();
            console.log('Link gerado:', linkPadrao);
            
            // Você pode usar esse link em botões, redirecionamentos, etc.
            // Exemplo: document.getElementById('meuBotao').href = linkPadrao;
        });
        
        // Exporta a função para uso global
        window.gerarLinkPadrao = gerarLinkPadrao;
    </script>
</body>
</html>
